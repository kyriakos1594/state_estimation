1. Graph neural networks on factor graphs for robust, fast, and scalable
linear state estimation with PMUs - Sustainable Energy, Grids and Networks

As phasor measurement units (PMUs) become more widely used in transmission power systems, a
fast state estimation (SE) algorithm that can take advantage of their high sample rates is needed.
To accomplish this, we present a method that uses graph neural networks (GNNs) to learn complex
bus voltage estimates from PMU voltage and current measurements. We propose an original imple-
mentation of GNNs over the power system’s factor graph to simplify the integration of various types
and quantities of measurements on power system buses and branches. Furthermore, we augment the
factor graph to improve the robustness of GNN predictions. This model is highly efficient and scalable,
as its computational complexity is linear with respect to the number of nodes in the power system.
Training and test examples were generated by randomly sampling sets of power system measurements
and annotated with the exact solutions of linear SE with PMUs. The numerical results demonstrate that
the GNN model provides an accurate approximation of the SE solutions. Furthermore, errors caused by
PMU malfunctions or communication failures that would normally make the SE problem unobservable
have a local effect and do not deteriorate the results in the rest of the power system.

Inspired by [27], we present the first use of GNNs on factor
graphs [28] for the SE problem, instead of using the bus-
branch power system model. This enables trivial integration
and exclusion of any type and number of measurements
on the power system buses and branches, by adding or
removing the corresponding nodes in the factor graph. Fur-
thermore, the factor graph is augmented by adding direct
connections between variable nodes that are 2nd-order
neighbours to improve information propagation during
neighbourhood aggregation, particularly in unobservable
scenarios when the loss of the measurement data occurs.
• We present a graph attention network (GAT) [5] model,
with the architecture customised for the proposed hetero-
geneous augmented factor graph, to solve the SE problem.
GNN layers that aggregate into factor and variable nodes
have separate sets of trainable parameters. Furthermore,
separate sets of parameters are used for variable-to-variable
and factor-to-variable message functions in GNN layers that
aggregate into variable nodes.
• Given the sparsity of the power system’s graph, and the fact
that node degree does not increase with the total number
of nodes, the proposed approach has O(n) computational
complexity, making it suitable for large-scale power sys-
tems. The inference of the trained GNN is easy to distribute
and parallelise. Even in the case of centralised SE imple-
mentation, the processing can be done using distributed
computation resources, such as graphical-processing units.
• We demonstrate that the number of trainable parameters
in the proposed GNN-based SE model is constant, while it
grows quadratically with the number of measurements in
conventional deep learning approaches.
• We study the local-processing nature of the proposed model
and show that significant degradation of results caused by
PMU or communication failures affects only the local neigh-
bourhood of the node where the failure occurred.

Inspired by recent work on using probabilistic graphical mod-
els for power system SE [33], we first create a GNN over a graph
with a factor graph topology. This bipartite graph consists of fac-
tor and variable nodes, and edges between them. Variable nodes
are used to create a s-dimensional node embedding for all real
and imaginary parts of the bus voltages, R(Vi ) and I(Vi ), which
are used to generate state variable predictions. Factor nodes, two
per measurement phasor, serve as inputs for the measurement
values, variances, and covariances, also given in rectangular coor-
dinates. These values are then transformed and sent to variable
nodes via GNN message passing. Unlike the approximative WLS
SE, the GNN includes measurement covariances in the inputs
without increasing the computational complexity. To achieve bet-
ter representation of node’s neighbourhood structure, we perform
variable node feature augmentation using binary index encod-
ing. Since variable nodes have no additional input features, this
encoding allows the GNN to better capture the relationships be-
tween nodes. Compared to one-hot encoding used in [29], binary
index encoding significantly reduces the number of input neurons

Unlike approaches that apply GNNs over the bus-branch
power system model, such as in [24,26], the using GNNs over
factor-graph-like topology allows for the incorporation of various
types and quantities of measurements on both power system
buses and branches. The ability to simulate the addition or re-
moval of various measurements can be easily achieved by adding
or removing factor nodes from any location in the graph. In
contrast, using a GNN over the bus-branch power system model
would require allocating a single input vector to each bus that
includes all potential measurement data for that bus and its
neighbouring branches. This can cause problems, such as having
to fill elements in the input vector with zeros when not all
possible measurements are available, and making the output
sensitive to the order of measurements in the input vector. This
can make it difficult to accurately model the system and generate
reliable results

Augmenting the factor graph topology by connecting the vari-
able nodes in the 2-hop neighbourhood significantly improves
the model’s prediction quality in unobservable scenarios [29].
This is because the graph should remain connected even when
we remove factor nodes to simulate measurement loss. This will
allow the messages to be still propagated in the whole K -hop
neighbourhood of the variable node. In other words, a factor node
corresponding to a branch current measurement can be removed
while still preserving the physical connection between the power
system buses. This requires an additional set of trainable param-
eters for the variable-to-variable message function. Although the
augmented factor graph displayed with both full and dashed lines
in Fig. 2 is not a factor graph because it is no longer bipartite,
we will still refer to the nodes as factor and variable nodes for
simplicity.
Since the proposed GNN operates on a heterogeneous graph,
we use two different types of GNN layers: one for aggregation
in factor nodes, and one for variable nodes. These layers, de-
f
v
noted as Layerf (·|θ Layer ) : Rdeg(f )·s ↦ → Rs and Layerv (·|θ Layer ) :
deg(v )·s
s
R
↦→ R , have their own sets of trainable parameters
f
v
θ Layer and θ Layer , allowing their message, aggregation, and update
functions to be learned separately. Additionally, we use different
sets of trainable parameters for variable-to-variable and factor-
f→v
to-variable node messages, Messagef→v (·|θ Message ) : R2s ↦ →
v→v
u
Messagev→v
2s
u
R and Message
(·|θ
) : R
↦→ R , in the Layerv
Layerv
(·|θ
) layer. In both GNN layers, we use two-layer feed-
forward neural networks as message functions, single layer neural
networks as update functions and the attention mechanism in the
aggregation function. Furthermore, we apply a two-layer neural
network Pred(·|θ Pred ) : Rs ↦ → R to the final node embeddings hK
of variable nodes only, to create state variable predictions xpred .
For factor and variable nodes with indices f and v , neighbourhood
aggregation and state variable prediction can be described as:

Because the node degree in the power system graph does
not increase with the total number of nodes, the same is true
for the node degrees in the augmented factor graph. This means
that the inference time per variable node remains constant, as it
only requires information from the node’s K -hop neighbourhood,
whose size also does not increase with the total number of nodes.
This implies that the computational complexity of inferring all
state variables is O(n). To avoid the over-smoothing problem in
GNNs [34], a small value is assigned to K , thus not affecting the
overall computational complexity of the inference.
To make the best use of the proposed approach for large-
scale power systems, the inference should be performed in a
computationally and geographically distributed manner. This is
necessary because the communication delays between the PMUs
and the central processing unit can hinder the full utilisation of
the PMUs’ high sampling rates. The distributed implementation
is possible as long as all the measurements within a node’s K -
hop neighbourhood in the augmented factor graph are fed into
the computational module that generates the predictions. For any
arbitrary K , the GNN inference method only requires PMUs that
are physically located within the ⌈K /2⌉-hop neighbourhood of
the power system bus.

In this subsection, we conduct a series of experiments on the
IEEE 30-bus power system, using measurement variances of 10−5 ,
10−3 , and 10−1 for the creation of the training, validation, and
test sets. We used higher variance values to model misalignments
in phasor measurements caused by communication delays [36].
The number and positions of PMUs are fixed and determined
using the optimal PMU placement algorithm [37], which finds
the smallest set of PMUs that make the system observable. This
algorithm has resulted in a total of 10 PMUs and 50 measurement
phasors, 10 of which are voltage phasors and the rest are current
phasors.
Table 1 shows the 100-sample test set results for all the exper-
iments on the IEEE 30-bus power system, in the form of average
mean square errors (MSEs) between the GNN predictions and the
test set labels. These results are compared with the average MSE
between the labels and the approximate WLS SE solutions defined
in Section 2.2 The results show that for systems with optimally
placed PMUs and low measurement variances, GNN predictions
have very small deviations from the exact WLS SE, although
they are outperformed by the approximate WLS SE. For higher
measurement variances, GNN has a lower estimation error than
the approximate WLS SE, while also having lower computational
complexity in all cases.
In this research, we investigate how GNN can be used as
fast solver of linear SE with PMUs. The proposed graph atten-
tion network-based model, specialised for the newly introduced
heterogeneous augmented factor graphs, recursively propagates
the input measurements from the factor nodes to generate pre-
dictions in the variable nodes. Evaluating the trained model on
unseen data samples confirms that the proposed GNN approach
can be used as a highly accurate approximator of the linear
WLS SE solutions, with the added benefit of linear computational
complexity at inference time. The model is robust in unobservable
scenarios that are not solvable using standard WLS SE and deep
learning methods, such as when individual phasor measurements
or entire PMUs fail to deliver measurement data to the pro-
posed SE solver. Furthermore, when measurement variances are
high or outliers are present in the input data, the GNN model
outperforms the approximate WLS SE. The proposed approach
demonstrates scalability and sample efficiency when tested on
power systems of various sizes, as it makes good predictions
even when trained on a small number of randomly generated
samples. Finally, the proposed GNN model outperforms the state-
of-the-art deep learning-based SE approach in terms of prediction
accuracy and significantly lower number of trainable parameters,
especially as the size of the power system grows.
In this work, we focused on using GNNs to solve a linear
SE model with only phasor measurements. However, the pro-
posed learning framework, graph augmentation techniques, and
conclusions can be applied to a wide range of SE formulations.
For example, our ongoing research employs the proposed frame-
work for the nonlinear SE model, which includes both PMUs and
legacy measurements provided by the supervisory control and
data acquisition system, with preliminary results available in [39].
Additionally, the GNN’s ability to provide relevant solutions in
underdetermined scenarios suggests that it could be useful for
GNN-based SE in highly unobservable distribution systems.
While our work shows promising results, an important lim-
itation is the inability to quantify the uncertainty of the GNN
predictions. However, we are encouraged by ongoing research
efforts to address this issue, as quantifying uncertainty for GNN
regression remains an open problem. For instance, [40] proposes
a Bayesian framework that uses assumed density filtering to
quantify aleatoric uncertainty and Monte Carlo dropout to cap-
ture epistemic uncertainty in GNN predictions. In light of this, we
believe implementing a similar approach represents a promising
future research direction.


2. Estimate Three-Phase Distribution Line Parameters
With Physics-Informed Graphical Learning Method -> ESTIMATES LINE PARAMETERS - IEEE TRANSACTIONS ON POWER SYSTEMS

Abstract—Accurate estimates of network parameters are essen-
tial for modeling, monitoring, and control in power distribution
systems. In this paper, we develop a physics-informed graphical
learning algorithm to estimate network parameters of three-phase
power distribution systems. Our proposed algorithm uses only
readily available smart meter data to estimate the three-phase
series resistance and reactance of the primary distribution line
segments. We first develop a parametric physics-based model to
replace the black-box deep neural networks in the conventional
graphical neural network (GNN). Then we derive the gradient of
the loss function with respect to the network parameters and use
stochastic gradient descent (SGD) to estimate the physical param-
eters. Prior knowledge of network parameters is also considered
to further improve the accuracy of estimation. Comprehensive
numerical study results show that our proposed algorithm yields
high accuracy and outperforms existing methods.


3. Graph Neural Network-Based Distribution
System State Estimators - Transactions On Industrial Informatics

Abstract—State estimation is an essential tool for situ-
ational awareness and control to ensure safe operation.
While current state-of-the-art techniques provide superior
performance over conventional approaches, they have poor
scalability and require large computational times. These
limitations can be overcome by utilizing deep learning mod-
els such as deep neural networks (DNNs). However, DNNs
are prone to over-fitting and cannot incorporate structural
information of networks. Furthermore, current model-based
approaches require detailed knowledge of network param-
eters that may be unavailable in large systems. There-
fore, new models with comparable performance are de-
sired that either do not require network parameters or
that can work using partial knowledge of these parame-
ters. Recently, graph neural networks (GNNs) have become
popular deep learning models that extend neural models
to graph structures and incorporate structural information
of the networks through graph structures. Therefore, this
article proposes GNN-based state estimators by modeling
the state estimation problem in distribution systems as
node-level prediction problems on their graph represen-
tations with state measurement matrices and tensors as
input features. Feature scaling and pseudo-measurement
generation phases are introduced to enhance their perfor-
mance. These approaches are evaluated on the IEEE 33,
37-node systems, and an unbalanced three-phase 559-node
system. The proposed approaches provide comparable per-
formance to sparsity-aware state estimators without requir-
ing prior knowledge of the network parameters while using
significantly lower computational times.
Recently, graph-based models such as graph neural networks
(GNNs) and their variants have received sconnecting nodes. Furthermore, some variants of GNNs can
incorporate different types of edges to model the intricacies
of real-world flows. GNNs have been used in various power
systems applications [7]. However, their application in DSSE
is still largely unexplored, with very few works in the litera-
ture [8], [9], [10], [11]. Some other possible graph structures
include modeling each measurement as a node and connecting
them with edges based on their dependencies. Current works
require detailed knowledge of network parameters, such as line
impedances, which may be unavailable or inaccurate, especially
for secondary and tertiary branches of large distribution systems.
Therefore, in this article, we propose to utilize GNNs to learn
the complex interactions among elements of distribution sys-
tems, and thus, develop GNN-based distribution system state
estimators. We begin with a brief review of the literature in the
following section.ignificant interest due
to their ability to model complex inter-dependencies among
objects [6]. GNNs can also incorporate structural information
as they operate on graph structures. Therefore, graph neural
networks can represent flow-based information through edges
Nonlinear interactions among measurements can
be incorporated into nonlinear factor models. Alternatively,
deep learning (DL) approaches that introduce nonlinearities
through their activation functions can be utilized. Furthermore,
DL approaches shift the computation burden to their training
phase and require significantly lower computational time during
evaluation. Therefore, DL approaches have often been used
to replace computationally heavy algorithms. DL approaches
have also been used to develop distribution system state es-
timators [4], [5]. Neural networks have been used to create
stand-alone state estimators and to preinitialize unknown mea-
surements for conventional state estimators. A neural network
approximation of a minimum mean squared error estimator is
developed in [4]. Monte Carlo sampling is utilized to generate
samples to train a DNN model to predict system states. A
pseudomeasurement modeling approach is proposed in [5] to
generate pseudomeasurements for active and reactive power
injections using artificial neural networks. State estimates are
then obtained through a weighted least squares estimator. While
neural networks used to generate pseudomeasurements aid in
improving state estimator performance, they do not solve the
problem of reducing computational time. Additionally, neural
networks fail to incorporate known dependencies, such as node
connectivities in power grids.
Recently, graph neural networks (GNN) have gained popu-
larity as they can handle rich relational information among ele-
ments [21]. GNNs enable the modeling of dependencies among
nodes in a graph and use them in various applications that can be
converted to node, edge, or graph-level prediction/classification
tasks. GNNs have also been used in various power systems
applications such as power flow calculations; data generation;
fault detection, isolation, and diagnosis; and time series pre-
dictions [7]. However, applications of GNN in distribution
system state estimation are still largely unexplored, with very
few works in literature [8], [9], [10], [11]. GNN-based state
estimators are proposed in [8] and [11], which model individual
bus measurements as nodes and their interactions through edges.
Zamzam and Sidiropoulos [9] utilized graph pruning techniques
to reduce the number of neural network connections, thereby
preventing over-fitting. Edge weights using network parameters
and multisampling rate measurements are incorporated in [10].
Current works require knowledge of network parameters such
as line impedances. However, detailed network models are typi-
cally unavailable, particularly in secondary and tertiary branches
of large distribution systems. Furthermore, unscaled features
result in large disparities in model weights, resulting in reduced
sensitivity to some features over others, and poor estimation
performance. Finally, a cold start for unknown features in GNNs
typically lowers their performance. These limitations motivate
the need to develop new GNN-based state estimators.
The state estimation problem in distribution systems can
be considered a node-level prediction problem of the GNN
operating on the graph representation of the distribution sys-
tem with state measurement matrices or tensors as input fea-
tures. Therefore, we propose to utilize GNNs to learn the
inherent relationships among the state measurement matrix
and tensor elements. The contributions of this article are as
follows.
1) Existing model-based sparsity-aware approaches rely on
detailed distribution system models to enforce conformity
with power flow constraints. The proposed GNN-based
approaches overcome this limitation as they do not re-
quire knowledge of network parameters and can learn
the inter-dependencies through data. Moreover, the pro-
posed approaches allow nonlinear interactions between
tensor elements. Thus, avoiding the bias introduced by
linearized power flow constraints used in model-based
approaches.
2) Unlike existing approaches, the proposed GNN-based
approaches introduce feature scaling to improve the sen-
sitivity of the estimator to all features. Additionally, a cold
start for unknown features typically lowers state estima-
tion performance. Therefore, a pseudomeasurement gen-
eration phase is introduced using estimates from previous
time windows to improve state estimation performance.
This step improves the state estimation performance
over vanilla graph convolutional network (GCN) mod-
els. Ablation studies confirm the effectiveness of these
modules.
3) Several existing techniques require network parameters
of the system to enforce constraints. However, detailed
models of the system are generally unavailable. The
evaluation of the state estimates with the average voltage
phasor error (AVPE) metric indicates that the proposed
feature matrices and tensors are sufficient to learn the
inter-dependencies of the grid measurements without the
need to introduce network parameters.
4) The proposed approaches show comparable performance
to model-based sparsity-aware state estimators while us-
ing significantly lower computational times at data avail-
abilities as low as 15% of the total measurements and in
the presence of measurement noise.
5) A comprehensive study of various model-free matrix and
tensor completion approaches for state estimation has
been performed. The results support current literature
that model-free approaches have inferior performance
when compared to model-based approaches. Additional
information such as power-flow constraints or network
connectivity information are necessary to obtain low-state
estimation errors under low data availability conditions.
The first approach, Matrix GCN with feature scaling and pseu-
domeasurements or MGCN-FP, utilizes multiple GCN layers op-
erating on graph representations of the distribution system with
state measurement matrices as input features. Feature scaling is
introduced to avoid large disparities between model weights and
to ensure greater sensitivity to all features. Learnings from [2]
are then utilized to introduce a pseudomeasurement generation
phase to reduce state estimation errors. Finally, measurements
across time are exploited by updating the graph structure of
the network with additional copies of the network graph. This
modification enables measurements across time instants to be
utilized and results in the tensor GCN with feature scaling
and pseudomeasurements approach (TGCN-FP). In practice, the
TGCN-FP approach should be preferred in networks with mixed
sampling rates since it allows utilizing measurements across
time, thereby improving performance. Their formulations are
described in the following sections.
Recent works on distribution system state estimation had
shown significant gains in state estimation performance using
matrix and tensor completion-based approaches. However, these
methods were computationally demanding and did not consider
nonlinear interactions among measurements. These limitations
can be overcome by developing deep learning-based alterna-
tives. For example, neural network models that utilized power
flow constraints had been developed for distribution system
state estimation. However, these approaches required complete
knowledge of the network parameters, which was typically
unavailable. Thus, new models that delivered performance on
par with model-based approaches without relying on network
constraints or necessitating complete knowledge of the network
parameters were desired. Therefore, GNN-based approaches
were proposed in this work. These approaches incorporated
node and edge connectivity information by operating on the
graph representation of the distribution systems. The proposed
approaches utilized state measurement matrices and tensors as
input features to graph neural network layers with additional
feature scaling and pseudomeasurement generation phases to
improve state estimation performance. The proposed approaches
were evaluated on the IEEE 33, 37-node distribution systems,
and an unbalanced three-phase 559-node distribution system
to show their applicability across single/three-phase systems
and different sizes of distribution systems. These approaches
provided comparable results to sparsity-aware state estimators
at data availabilities as low as 15% on the 559-node distribution
system without requiring knowledge of the network parameters.
The computational times of the proposed approaches were sev-
eral orders of magnitude lower than the model-based approaches
and were comparable to existing deep learning approaches.
Future work will incorporate topology processors and the ability
to utilize partial knowledge of the network parameters.


4. Physics-Informed Graphical Learning and Bayesian
Averaging for Robust Distribution State Estimation -> IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 39, NO. 2, MARCH 2024

Abstract—This article proposes a robust topology change-aware
distribution system state estimation (DSSE) method based on a
physics-informed graph neural network and Bayesian Probability
Weighted Averaging (BPWA). A general state estimator is first built
utilizing a graph attention network to learn the nonlinear mapping
functions under different distribution network topologies. During
this stage, the topology information is embedded in the neural
network and the attention mechanism is employed to capture col-
laborative signals and discriminate the importance of neighboring
buses. Then, the BPWA method allows assigning proper weights
for the state estimation results under different topologies, which
finally yields a single consensus solution via the sparse training
samples under the new topology. The physics-informed mechanism
enables the proposed method to embed the topology knowledge in
the neural network while fully exploiting the value of historical
data. Robustness to anomalous measurements is achieved through
the embedding of physics knowledge. The application of the BPWA
method further allows the proposed method to achieve faster
adaptation to topology change and quantification of the estimation
uncertainties by measurement errors. MATLAB and Python are
used to carry out the comparative tests to evaluate the performance
of the proposed method.
To this end, this article proposes a probabilistic robust DSSE
method based on a physics-informed graph neural network
(GNN) and Bayesian Probability Weighted Averaging (BPWA)
method. The main contributions are summarized as follows:
• The proposed DSSE method is robust to the loss of mea-
surements and bad data. This is achieved by the embedding
of network structural information in the GNN, which allows
the proposed method to avoid overfitting and learn a better
state estimator. This physics-based approach is different from
the black-box methods that suffer from significant performance
decline when encountering abnormal measurements.
• The BPWA method allows the proposed method to achieve
fast adaptation to a new topology using sparse online measure-
ments, which differentiates from conventional transfer learning-
based DSSE methods.
• The proposed method can effectively quantify the DSSE un-
certainties, which is useful for the distribution system operators
to make uncertainty-aware decisions.
Learning-based methods aim to recover the mapping rela-
tionship between measurements and state variables utilizing
historical data. The model is learned offline utilizing abundant
historical data, and the required calculation for state estimation
is minimal when executed online. This allows the learning-based
DSSE method to perform state estimation in real-time.
Although the learning-based methods have high computa-
tional efficiency, they face two challenges: 1) due to the lack
of physical information, the presence of missing and bad data
can yield significantly biased results; 2) lack of adaptiveness
to topology changes. To deal with them, this article proposes a
robust topology change-aware DSSE method based on a physics-
informed neural network and BPWA method.
The proposed method contains two main components, namely
i) physics-informed GNN for the learning of DSSE under dif-
ferent topologies and ii) the BPWA method for topology change
adaptation and uncertainty quantification. The framework of the
proposed method is shown in Fig. 1.
A. Physics-Informed GNN
The proposed physics-informed GNN has the following mod-
ules: 1) the attentive embedding propagation module, which
employs a graph attention layer to capture the relationships
between nodes during the propagation and applies a 1-D convo-
lution layer to extract common features from the global input;
2) the task-specific propagation module, which involves two
components that are responsible for the propagation of voltage
magnitude and angle, respectively; 3) the prediction module,
which aggregates the representations and outputs the predicted
voltage magnitude and angle.
1) The Attentive Embedding Propagation Module: The input
of the GNN includes the features of all nodes Z and the adjacency
matrix T, where Z ∈ RN ×4 is constructed based on the measure-
ments z to map the shape of the graph network. In the attentive
embedding propagation module, multi-head attention model is
utilized. Each attention head consists of a graph attention layer,
a convolution layer, and a fully connected layer. The graph
attention layer is first employed to learn the weight of each
neighbor and propagate embedding from a node’s neighbor
based on the adjacency matrix T to update its representation. The
representation of each node is calculated by the graph attention
layer based on the weight of each neighbor
⎛
⎞
L

k k
αij
gj (Z j )⎠ ,
(6)
hkatt,i = σSM ⎝
j=1
where j denotes an adjacent node of node i; Z j represents the
k
represents the attention weight
input features of node j; αij
of the kth attention head to evaluate the contribution of node
j to i; L is the number of adjacent nodes of node i; gjk (·)
represents the embedding function of the kth attention head for
node j, which is composed of a one-layer fully connected neural
network; σSM denotes the sigmoid activation function; hkatt,i
is the representation node i that are processed by the graph
attention layer of the kth attention head. The attention weight
k
is calculated according to
αij
ekij = σLR (wT (gik (Z i )||gjk (Z j )))(7)
exp(ekij )
,
L
k
l=1 exp(eij )(8)
k
=
αij
Where || denotes the concatenation operation of the repre-
sentations of two nodes; w represents a column vector; σLR
denotes the LeakyReLU activation function. The graph attention
layer propagates embedding from a node’s neighbors to refine its
representation and applies an attention mechanism to discrimi-
nate the weight of each neighbor [48]. This process enables the
proposed method to incorporate the topological knowledge in
the network, which can enhance the robustness of the learning
model.
The application of attention-based GNN enables the proposed
method to capture the relationships between adjacent nodes, but
The proposed physics-informed GNN has the following mod-
ules: 1) the attentive embedding propagation module, which
employs a graph attention layer to capture the relationships
between nodes during the propagation and applies a 1-D convo-
lution layer to extract common features from the global input;
2) the task-specific propagation module, which involves two
components that are responsible for the propagation of voltage
magnitude and angle, respectively; 3) the prediction module,
which aggregates the representations and outputs the predicted
voltage magnitude and angle.
1) The Attentive Embedding Propagation Module: The input
of the GNN includes the features of all nodes Z and the adjacency
matrix T, where Z ∈ RN ×4 is constructed based on the measure-
ments z to map the shape of the graph network. In the attentive
embedding propagation module, multi-head attention model is
utilized. Each attention head consists of a graph attention layer,
a convolution layer, and a fully connected layer. The graph
attention layer is first employed to learn the weight of each
neighbor and propagate embedding from a node’s neighbor
based on the adjacency matrix T to update its representation. The
representation of each node is calculated by the graph attention
layer based on the weight of each neighbor
This article proposes a robust topology change-aware DSSE
method based on the physics-informed GNN and BPWA. His-
torical data are first utilized to learn the nonlinear relationship
between the measurements and state variables under different
topologies. During this stage, the structural knowledge of his-
torical topologies is embedded into the GNN. Then, the BPWA
method is applied to address the estimation problem utilizing
sparse training samples recorded under the new topology. Com-
parative tests with several benchmarking methods demonstrate
that: 1) the proposed method is robust to the anomalous measure-
ments and achieves much better performance than the traditional
learning-based method when some real-time measurements are
lost; 2) the proposed method can achieve fast adaption to topol-
ogy changes utilizing a limited amount of samples recorded
under the new topology; 3) when dealing with a new topology,
the BPWA method can preserve the robustness achieved by
the physics-informed graph attention network in presence of
outliers; 4) the BPWA allows the proposed method to achieve
effective quantification of the state estimation uncertainties. In
our future works, more intelligent methods that can detect and
better deal with PV connection scenarios will be developed.


5. Distribution Network Topology Identification with
Graph Transformer Neural Network - Conference

Abstract— The safety and stable operation of distribution
networks is of great significance to ensure reliable power supply.
Obtaining the dynamic topology of the distribution network
quickly and accurately is important to carry out system state
assessment and ensure system operation quality. However, it is
difficult to directly collect the real-time status of all switches and
lines in a distribution system, due to the limitation of the
deployment capability and data noise or mistake of the
measurement device. In this paper, a topology identification
model based on graph transformer neural network is proposed
to calculate and infer the current topological distribution based
on incomplete measurement information, aiming to overcome
the insufficiency and inaccuracy of traditional methods. First,
the data of distribution network is converted into a graph model
and effective features of system operation are selected. Then, the
graph-transformer-network-based topology identification
model of power distribution system is jointly trained by node
features, node labels and node connections, which can improve
computational efficiency while increasing the amount of input
information. Finally, the effectiveness and generalization of the
proposed method are verified on IEEE 33 case and PG&E 69
case.
For general distribution network systems, due to the high-
frequency fluctuations and overruns of power flow caused by
the uncertainty of distributed power and loads, as well as
operation and maintenance, system failures, etc., the
switching action of feeders become more and more frequently.
This resulting in a changing structure of the network and a
more diverse and complex mode of operation, and network
security stability control and economic operation analysis are
challenged[4]. Compared with the transmission network, the
distribution network has limited measurement equipment and
lacks real-time telemetry and remote signaling[1]; at the same
time, if the topology changes during data collection, the
availability of data cannot be guaranteed, and the monitoring
information of real-time topology and line parameters is often
lost or unreliable. Therefore, in order to ensure the power
quality, it is necessary to carry out real-time topology
identification and intelligent dispatching of the distribution
network to realize the safe operation of the distribution
network.
Distribution network topology identification methods can
be mainly divided into two categories. One class of methods
is based on traditional system power flow analysis and state
estimation. Reference [5] compares the new measured data
with the calculation results under different topology cases, and
determines the one with the smallest error as the current actual
topology. In addition, this paper concludes that the voltage
phase angle produces more accurate information than the
voltage amplitude. Reference [6] takes the power flow and the
state of circuit breakers as state variables, and introduces
additional pseudo-measurements according to the telemetry
state of each circuit breaker, extending the traditional state
estimation based on Weighted Least Square (WLS). In [7],
authors use asynchronous voltage data to verify the grid
topology. By analyzing the voltage covariance matrix and
simplifying the data model, the topology identification task is
relaxed into a convex function, which is then transformed into
a maximum likelihood (ML) problem. Most of these methods
require the distribution system to be equipped with more
comprehensive real-time measurement of nodes and branches.
However, due to the influence of economy and
communication technology, it is not feasible to install high-
precision measurement devices at all nodes, so it is difficult to
implement in practical applications.
In order to solve the two shortcomings of GCN about
scalability and depth, graph attention network (GAT) was
born, which specially fixes the problem that different neighbor
nodes have different weights in the process of GCN
aggregating neighbor nodes[17],[18].
Attention mechanism is a concept that is widely applied in
recent deep learning models, and it firstly used to improve the
performance of neural machine translation. Transformer is
proposed by the paper “Attention is All You Need”[17], it is a
model architecture based entirely on the self-attention
mechanism. Its success is largely due to the multi-head
attention mechanism,which improves the training speed of the
model. The input context information is encoded and enables
the model to learn the dependencies between different input
tokens.
The graph attention network draws on the attention
mechanism in the Transformer model, and can assign different
weights to it, according to the different characteristics of
neighbor nodes in the calculation graph. The paper “Graph
Attention Network”[20] introduced the graph attention
mechanism into the graph neural network for the first time,
which has been widely used in many fields now. The
improved graph transformer network (GTN) is also deformed
from this. GTN aggregates neighbor nodes through the self-
attention mechanism to achieve adaptive matching of different
neighbor weights, thereby improving the accuracy of the
model. The GCN model trained based on the attention
mechanism does not need to know the entire graph structure,
but only needs to know the neighbor nodes of each node. The
calculation speed is fast, and it can perform parallel computing
structures. Supervised tasks can also handle unsupervised
tasks.
In order to improve the accuracy and generalization ability
of distribution network topology identification, this paper
proposes a topology identification method with a graph deep
learning approach based on self-attention mechanism. This
method makes use of the natural graph structure properties of
the electric connection structure of system as prior knowledge,
and incorporates the features of the line and connection
relationship with surrounding lines and bus into the
calculation process. The effectiveness of the method is
verified by the IEEE 33 node and PG&E 69 node distribution
networks. The result shows that the accuarcy and
generalization ability of the proposed methed for unseen
topologies have been noticeably improved compared to
traditional meachine learning models.
This paper conducts a preliminary study on the application
of graph deep learning in distribution network topology
identification. The follow-up research work is to build and
optimize the model when missing some node information and
to further improve the application feasibility of the topology
recognition mode.





